# INFORMACIONI SISTEM ZA PODRŠKU POSLOVANJA ŠKOLE STRANIH JEZIKA
![16](https://user-images.githubusercontent.com/61964257/145106106-75f21903-46ea-4974-84a2-75fdcbe344f2.PNG)

Sve vrste kursa koje škola ima u ponudi modeluju se pomoću tipa entiteta *Vrsta_kursa*. Jezici, nivoi i intenziteti izmodelovani su pomoću tipova entiteta *Jezik*, *Nivo* i *Intenzitet* respektivno. Svaka vrsta kursa se formira na osnovu tri glavna faktora: jezika, nivoa i intenziteta. Jedan konkretan jezik, nivo i intenzitet može učestvovati u formiranju više vrsti kursa, a ne mora ni u jednoj. Sa druge strane, jedna vrsta kursa može biti formirana samo na osnovu jednog jezika, jednog nivoa i jednog intenziteta. Ovo formiranje modelovano je tipovima poveznika *jezik_vk*, *nivo_vk* i *intenzitet_vk* respektivno. Tip entiteta *Kurs* predstavlja realizaciju jedne vrste kursa. Na osnovu jedne vrste kursa može biti formirano više realizacija kursa, a ne mora ni jedna. Registrovani korisnici u školi stranih jezika modeluju se pomoću tipa entiteta *Registrovani_korisnik*. Tip entiteta *Stranka* modeluje korisnike koji mogu biti *Potpisnik* i/ili *Polaznik*. Potpisnici su zaduženi za potpisivanje ugovora za polaznika, ukoliko je polaznik maloletan, dok je polaznik lice koje pohađa dati kurs. Registrovani korisnik ne mora da postane
stranka ukoliko na primer odustane od pohađanja kursa, dok može postati maksimalno jedna stranka. Stranka ne mora da bude registrovani korisnik jer se može i lično prijaviti za vrstu kursa. Takođe, jedna stranka može da predstavlja više registrovanih korisnika, ukoliko registrovani korisnik ima više naloga putem kojih je izvršio rezervaciju. Jedna stranka mora biti ili polaznik ili potpisnik, a može biti i polaznik i potpisnik u isto vreme. Ugovore koji nastaju prilikom upisa polaznika i koje potpisuje sam polaznik ili potpisnik koji je zadužen za njega modeluju se pomoću tipa entiteta *Ugovor*. Tipom poveznika *na_osnovu* modelujemo vezu da ugovor nastaje na osnovu kursa. Jedan ugovor može biti formiran na osnovu jednog i samo jednog kursa, dok na osnovu jednog kursa može biti formirano više ugovora, a ne mora nijedan. Tipom poveznika *je_zaduzen* modelujemo vezu da je potpisnik zadužen za polaznika. Jedan potpisnik može biti zadužen za više polaznika, a ne mora ni za jednog, dok za jednog polaznika može biti zadužen samo jedan potpisnik. Tipom poveznika *se_odnosi* modelujemo vezu gde se ugovor odnosi na polaznika. Jedan ugovor se odnosi na tačno jednog polaznika, dok se na polaznika može odnositi jedan ili više ugovora. *Potpisnik* koji je zadužen za polaznika potpisuje ugovor koji se odnosi na tog istog polaznika. Potpisnik može da potpiše jedan ili više ugovora koji se odnose na tog polaznika, dok jedan ugovor može da potpiše samo jedan potpisnik. *Zaposleni* može biti ili *Sekretar* ili nešto pored toga, a u isto vreme može imati i više funkcija. Sekretar je zadužen za formiranje ugovora što se modeluje tipom poveznika *formira*.

## SQL upiti
U skripti sa SQL upitima kreirano je pet upita:
1. Upit: Upit koji izlistava JMBG, ime, prezime, pol i datum rođenja svih sekretara koji trenutno rade u školi stranih jezika. Ukoliko je aktivnost_zap 0 sekretar više ne radi u školi i u tom slučaju neće biti izlistan, a ukoliko je aktivnost_zap 1 sekeretar trenutno radi u školi i biće izlistan.
2. Upit: Upit koji izlistava ime, prezime, kao i godinu rođenja svih onih polaznika koji su maloletni. U upitu je korišćena funkcija *getdate()* koja vraća trenutni datum. Pomoću datepart od trenutnog datuma se izvlači samo trenutna godina jer je to zahtevano uz pomoć yyyy. Ukoliko se od trenutne godine oduzme godina rođenja polaznika i ukoliko je ona manja od 18 polaznik je maloletan.
3. Upit: Upit koji izlistava ID kursa, naziv kursa, kao i broj polaznika čija je cena veća od prosečne cene svih kurseva, kao i broj polaznika na njemu. U ovom upitu su korišćene dve funkcije. Prva funkcija je agregatna - COUNT funkcija (u ovom upitu vraća broj polaznika na tom kursu) i druga grupna, *AVG* funkcija (u ovom upitu vraća prosečnu vrednost svih kurseva).
4. Upit: Upit koji izlistava sve polaznike i naziv ustanove koju polaznik pohađa ili u kojoj radi za sve polaznike koji su potpisali ugovore na kurseve standardnog inteziteta. U ovom upitu je korišćena funkcija za rad sa nizovima karaktera - UPPER funkcija, koja menja sva mala slova u velika.
5. Upit: Upit koji izlistava email sekretara koji je formirao ugovore za Anu Perić za kurs koji je počeo između 01.01.2020. i 31.01.2020.

## SQL procedure
U skripti za kreiranje procedura kreirane su dve procedure:
1. procedura - Procedura prolazi kroz kompletnu listu Email adresa svih korisnika koji su registrovani u školi stranih jezika i proverava njegovu validnost. Ukoliko je u Email-u izostavljen znak "@" vrši se zamnea neispravne vrednosti sa ispisom "Email je neispravan!".
2. procedura - Procedura prolazi kroz sve registrovane korisnike i za svakog registrovanog korisnika koji nije stranka, tj. koji nije ni polaznik, a ni potpisnik na kraj imena stavlja 'X'. Promenljive se definišu rezervisanom rečju *DECLARE*. Iskaz *SET NOCOUNT* poboljšava performanse uskladištene procedure. Prilikom pokretanja procedure poruka „xx row(s) affected“ se ne prikazuje.
U obe procedure korišćeni su kursori.

## SQL funkcije
U skripti za kreiranje funkcija kreirane su dve funkcije:
1. funkcija: Kreirana je funkcija *VratiNaziv* koja za prosleđeni *no_kurs* vraća naziv vrste kursa za tu realizaciju kursa.
2. funkcija: Kreirana funkcija vraća vrednost jedne rate za cenu kursa. Broj rata je definisan ugovorom.

## SQL trigeri
U skripti za kreiranje trigera kreirana su dva trigera:
1. triger - Kreiran je triger koji će prilikom formiranja novog ugovora proveriti najpre kapacitet za uneti kurs i ukoliko je broj popunjenih mesta veći od kapaciteta onemogućeno je insertovanje, tj. onemogućeno je formiranje novog ugovora za traženi kurs.
2. triger - Kreiran je triger koji zabranjuje menjanje cene kursa u periodu od 15.03.2020 do 15.05.2020.
